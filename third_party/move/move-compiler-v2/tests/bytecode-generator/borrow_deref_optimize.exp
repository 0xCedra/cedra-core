// -- Model dump before bytecode pipeline
module 0x42::test {
    struct X {
        value: bool,
    }
    private fun no_optimize_resource(): bool
        acquires test::X(*)
     {
        {
          let x: &mut test::X = Borrow(Mutable)(Deref(BorrowGlobal(Immutable)<test::X>(0x1)));
          select test::X.value<&mut test::X>(x)
        }
    }
    private fun no_optimize_vector() {
        {
          let _: &mut u64 = vector::borrow_mut<u64>(Borrow(Mutable)(Deref(vector::borrow<vector<u64>>(Borrow(Immutable)([Vector([Number(1), Number(2)])]), 0))), 1);
          Tuple()
        }
    }
    private fun optimize_resource(): bool
        acquires test::X(*)
     {
        {
          let x: &test::X = Borrow(Immutable)(Deref(BorrowGlobal(Immutable)<test::X>(0x1)));
          select test::X.value<&test::X>(x)
        }
    }
    private fun optimize_vector() {
        {
          let x: vector<vector<u64>> = [Vector([Number(1), Number(2)])];
          {
            let _: &mut u64 = vector::borrow_mut<u64>(Borrow(Mutable)(Deref(vector::borrow_mut<vector<u64>>(Borrow(Mutable)(x), 0))), 1);
            Tuple()
          }
        }
    }
} // end 0x42::test

============ initial bytecode ================

[variant baseline]
fun test::no_optimize_resource(): bool {
     var $t0: bool
     var $t1: &mut test::X
     var $t2: &mut test::X
     var $t3: test::X
     var $t4: &test::X
     var $t5: address
     var $t6: &bool
  0: $t5 := 0x1
  1: $t4 := borrow_global<test::X>($t5)
  2: $t3 := read_ref($t4)
  3: $t2 := borrow_local($t3)
  4: $t1 := infer($t2)
  5: $t6 := borrow_field<test::X>.value($t1)
  6: $t0 := read_ref($t6)
  7: return $t0
}


[variant baseline]
fun test::no_optimize_vector() {
     var $t0: &mut u64
     var $t1: &mut vector<u64>
     var $t2: vector<u64>
     var $t3: &vector<u64>
     var $t4: &vector<vector<u64>>
     var $t5: vector<vector<u64>>
     var $t6: u64
     var $t7: u64
     var $t8: &mut u64
  0: $t5 := ["[\"1\", \"2\"]"]
  1: $t4 := borrow_local($t5)
  2: $t6 := 0
  3: $t3 := vector::borrow<vector<u64>>($t4, $t6)
  4: $t2 := read_ref($t3)
  5: $t1 := borrow_local($t2)
  6: $t7 := 1
  7: $t0 := vector::borrow_mut<u64>($t1, $t7)
  8: $t8 := infer($t0)
  9: return ()
}


[variant baseline]
fun test::optimize_resource(): bool {
     var $t0: bool
     var $t1: &test::X
     var $t2: &test::X
     var $t3: address
     var $t4: &bool
  0: $t3 := 0x1
  1: $t2 := borrow_global<test::X>($t3)
  2: $t1 := infer($t2)
  3: $t4 := borrow_field<test::X>.value($t1)
  4: $t0 := read_ref($t4)
  5: return $t0
}


[variant baseline]
fun test::optimize_vector() {
     var $t0: vector<vector<u64>>
     var $t1: vector<vector<u64>>
     var $t2: &mut u64
     var $t3: &mut vector<u64>
     var $t4: &mut vector<vector<u64>>
     var $t5: u64
     var $t6: u64
     var $t7: &mut u64
  0: $t1 := ["[\"1\", \"2\"]"]
  1: $t0 := infer($t1)
  2: $t4 := borrow_local($t0)
  3: $t5 := 0
  4: $t3 := vector::borrow_mut<vector<u64>>($t4, $t5)
  5: $t6 := 1
  6: $t2 := vector::borrow_mut<u64>($t3, $t6)
  7: $t7 := infer($t2)
  8: return ()
}


============ bytecode verification succeeded ========
