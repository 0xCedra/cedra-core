apiVersion: v1
kind: Pod
metadata:
  name: {{ include "aptos-fullnode.fullname" . }}-sync-test
  annotations:
    "helm.sh/hook": test
spec:
  containers:
    - name: {{ include "aptos-fullnode.fullname" . }}-sync-test
      image: {{ .Values.test.image.repo }}:{{ .Values.test.image.tag }}
      imagePullPolicy: {{ .Values.image.pullPolicy }}
      command:
        - sh
        - -c
        - |-
          set -ex
          curl --fail http://{{ include "aptos-fullnode.fullname" . }}-lb:80
  restartPolicy: Never
